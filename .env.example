# ============================================================================
# Core environment variables with placeholders and recommended defaults.

# Provider: gemini | openai | anthropic | custom
VITE_AI_PROVIDER=gemini

# API key (REQUIRED) - set your provider key here
VITE_AI_API_KEY=your_api_key_here
# Optional per-provider fallbacks
# VITE_GEMINI_API_KEY=
# VITE_OPENAI_API_KEY=

# Model and generation
VITE_AI_MODEL=gemini-2.5-flash
VITE_AI_TEMPERATURE=0.2

# Feature flags (true/false)
VITE_FEATURE_CACHE=true
VITE_FEATURE_FILE_PROCESSING=true
# Enable mock mode for testing without consuming API quota (recommended for development)
# MOCK_MODE_ENABLED=true
# MOCK_MODE_DELAY_MS=500

# Rate limiting & timeouts (recommended balanced defaults)
# Number of retries for transient failures (reduced to 2 to avoid quota waste on rate limit errors)
# Note: Rate limit errors (429) and auth errors (401/403) fail fast without retrying
VITE_RATE_LIMIT_MAX_RETRIES=2
# Base delay between retries (ms)
VITE_RATE_LIMIT_DELAY_MS=800
VITE_RATE_LIMIT_EXPONENTIAL_BACKOFF=true
# Server-side request timeout for vision/classification (ms)
VITE_AI_REQUEST_TIMEOUT_MS=120000

# PHASE 4: Optimized Configuration for Stage 2 Background Analysis
# AI Generation Timeout (milliseconds) - for narrative text generation (Stage 2)
# Optimized for 2-4k token outputs (typically 30-120 seconds)
# Server-only configuration (read by server/index.cjs)
# Default: 180000 (3 minutes - balanced for typical diagrams)
AI_GENERATION_TIMEOUT_MS=180000

# Token Budget Configuration (Dynamic Calculation)
# These values control how token budgets scale with diagram complexity
# Formulas:
#   maxOutputTokens = min(BASE_OUTPUT_TOKENS + (componentCount × TOKENS_PER_COMPONENT), MAX_OUTPUT_TOKENS_CAP)
#   thinkingBudget = min(BASE_THINKING_TOKENS + (componentCount × THINKING_TOKENS_PER_COMPONENT), MAX_THINKING_TOKENS_CAP)

# Output token calculation parameters
TOKENS_PER_COMPONENT=150
BASE_OUTPUT_TOKENS=2000
MAX_OUTPUT_TOKENS_CAP=16384

# Thinking token calculation parameters
THINKING_TOKENS_PER_COMPONENT=100
BASE_THINKING_TOKENS=2048
MAX_THINKING_TOKENS_CAP=8192

# Example budgets (with increased limits for complete reports):
#   5 components:   2,750 output + 2,548 thinking = 5,298 tokens
#   21 components:  5,150 output + 4,148 thinking = 9,298 tokens
#   100 components: 16,384 output + 8,192 thinking = 24,576 tokens (at caps)

# File processing
VITE_FILE_MAX_SIZE=10485760
VITE_FILE_SUPPORTED_FORMATS=pdf,png,jpg,jpeg,dwg
VITE_FILE_PDF_DPI=300

# Dev server (optional)
VITE_PORT=3000
VITE_HMR_CLIENT_PORT=3000

# Thresholds - Calibrated for High Recall (Zero-HITL)
# Confidence threshold for component detection (0.0-1.0)
VITE_HIGH_CONFIDENCE_THRESHOLD=0.9

# Visual Processing - Selective Tiling Configuration
# Grid tiling requires 4x API calls (one per tile) plus final merge analysis
# Only tile images larger than this dimension to avoid wasting money on small PDFs
# Recommended: 2000px (balanced accuracy vs cost)
VITE_TILING_THRESHOLD_PX=2000

# Cache Management - LocalStorage Limits
# Browsers limit localStorage to 5-10MB. This sets a conservative cache limit
# to prevent QuotaExceededError. Set lower if experiencing storage issues.
# Default: 4194304 (4MB - conservative for browser compatibility)
VITE_CACHE_MAX_SIZE_BYTES=4194304

# Centralized serverConfig recommended overrides (placeholders)
# These are read by frontend/lib/serverConfig.ts and serverAI.ts
VITE_MAX_THINKING_BUDGET=8000
VITE_MIN_THINKING_BUDGET=3000
VITE_MAX_THINKING_BUDGET_CAP=20000
VITE_DEFAULT_THINKING_BUDGET=8000
VITE_DEFAULT_MAX_OUTPUT_TOKENS=8192
VITE_IMAGE_SIZE_DIVISOR=2000
VITE_BACKOFF_MULTIPLIER=1.8
VITE_HIGH_CONFIDENCE_THRESHOLD=0.9

# Data root for server (defaults to ./data/projects if unset in code)
# Set to server/data to use the server-local data directory
DATA_ROOT=./server/data
